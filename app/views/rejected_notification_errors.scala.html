@*
 * Copyright 2020 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@import models.declaration.submissions.Submission
@import services.model.RejectionReason
@import views.Title
@import config.AppConfig

@this(main_template: views.html.main_template, appConfig: AppConfig)

@(submission: Submission, errors: Seq[RejectionReason])(implicit request: Request[_], messages: Messages)

@main_template(title = Title("rejected.notification.title"), fullWidth = true) {

    @components.back_link(routes.SubmissionsController.displayListOfSubmissions())

    <br/>

    @components.heading(
        sectionHeader = messages("rejected.notification.ucr", submission.ducr.getOrElse("No DUCR")),
        title = messages("rejected.notification.title"))

    <span id="information">@messages("rejected.notification.information")</span>

    <table>
        <thead>
            <tr class="table-row">
                <th class="table-cell table-head rejected-field-name">@messages("rejected.notification.header.fieldName")</th>
                <th class="table-cell table-head rejected-error-description">@messages("rejected.notification.header.errorDescription")</th>
                <th class="table-cell table-head rejected-error-code">@messages("rejected.notification.header.errorCode")</th>
            </tr>
        </thead>

        <tbody>
            @for((error, index) <- errors.zipWithIndex) {
              <tr class="table-row" id="rejected_notifications-row-@index">
                <th class="table-cell table-head rejected-field-name" id="rejected_notifications-row-@index-name">
                    @Html(error.pointer.map(p => messages(p.messageKey, p.sequenceArgs: _*)).getOrElse(""))
                </th>
                <td class="table-cell rejected-error-description" id="rejected_notifications-row-@index-description">
                    @if(appConfig.isUsingImprovedErrorMessages) {
                        @error.exportsDescription
                    } else {
                        @error.cdsDescription
                    }
                </td>
                <td class="table-cell rejected-error-code" id="rejected_notifications-row-@index-code">@error.code</td>
              </tr>
            }
        </tbody>
    </table>

    <br/>
    <br/>

    <a href="@routes.SubmissionsController.amend(submission.uuid)"
        target="_blank" id="continue">@messages("rejected.notification.continue")</a>
}